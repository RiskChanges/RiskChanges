import pandas as pd
import psycopg2

def readIntVuln(connstr,vulnid):
    try: 
        engine=psycopg2.connect(connstr)
    except :
        print("unable to create connection")
    sql_val=f'SELECT * FROM public."projectIndex_vulvalues" as vulntable WHERE vulntable."vulnID_fk"={vulnid};'
    #print(sql_val)
    vulntable=pd.read_sql(sql_val,engine)
    vulntable['mean_x'] =vulntable.apply(lambda row: (row.hazIntensity_from+row.hazIntensity_to)/2, axis=1)
    engine.close()
    assert not metatable.empty , f"The vulnerability table for id {vulnid} do not exists"
    return vulntable

def readSusVuln(connstr,vulnid):
    try: 
        engine=psycopg2.connect(connstr)
    except :
        print("unable to create connection")
    sql_val=f'SELECT * FROM public."projectIndex_vulvalues" as vulntable WHERE vulntable."vulnID_fk"={vulnid};'
    #print(sql_val)
    vulntable=pd.read_sql(sql_val,engine)
    vulntable.rename(columns={"hazIntensity_from": "mean_x"})
    engine.close()
    assert not metatable.empty , f"The vulnerability table for id {vulnid} do not exists"
    return vulntable

